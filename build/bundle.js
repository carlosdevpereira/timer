var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function r(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,n,i){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}(n,i))}function c(t){return null==t?"":t}function a(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function d(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t){return""===t?void 0:+t}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}function _(t,e){(null!=e||t.value)&&(t.value=e)}function T(t,e){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e)return void(i.selected=!0)}}let k;function $(t){k=t}const S=[],b=[],w=[],y=[],I=Promise.resolve();let A=!1;function x(t){w.push(t)}let C=!1;const W=new Set;function E(){if(!C){C=!0;do{for(let t=0;t<S.length;t+=1){const e=S[t];$(e),P(e.$$)}for(S.length=0;b.length;)b.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];W.has(e)||(W.add(e),e())}w.length=0}while(S.length);for(;y.length;)y.pop()();A=!1,C=!1,W.clear()}}function P(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(x)}}const F=new Set;let R;function N(t,e){t&&t.i&&(F.delete(t),t.i(e))}function q(t,e,n,i){if(t&&t.o){if(F.has(t))return;F.add(t),R.c.push(()=>{F.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}}function B(t){t&&t.c()}function D(t,n,o){const{fragment:s,on_mount:c,on_destroy:a,after_update:l}=t.$$;s&&s.m(n,o),x(()=>{const n=c.map(e).filter(r);a?a.push(...n):i(n),t.$$.on_mount=[]}),l.forEach(x)}function M(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function O(t,e){-1===t.$$.dirty[0]&&(S.push(t),A||(A=!0,I.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,r,o,s,c,a,l=[-1]){const f=k;$(e);const g=r.props||{},m=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:l};let d=!1;if(m.ctx=o?o(e,g,(t,n,...i)=>{const r=i.length?i[0]:n;return m.ctx&&c(m.ctx[t],m.ctx[t]=r)&&(m.bound[t]&&m.bound[t](r),d&&O(e,t)),n}):[],m.update(),d=!0,i(m.before_update),m.fragment=!!s&&s(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(u)}else m.fragment&&m.fragment.c();r.intro&&N(e.$$.fragment),D(e,r.target,r.anchor),E()}$(f)}class j{$destroy(){M(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const V=[];function G(e,n=t){let i;const r=[];function s(t){if(o(e,t)&&(e=t,i)){const t=!V.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(o,c=t){const a=[o,c];return r.push(a),1===r.length&&(i=n(s)||t),o(e),()=>{const t=r.indexOf(a);-1!==t&&r.splice(t,1),0===r.length&&(i(),i=null)}}}}const z={requestPermission:()=>Notification.requestPermission(),hasPermissionToSend:()=>"granted"==Notification.permission,send:function(t,e){this.hasPermissionToSend()&&null!==t&&navigator.serviceWorker.getRegistration().then(n=>n.showNotification(t,{icon:"/assets/img/brand.png",badge:"/assets/img/brand.png",vibrate:[200,100,200],timestamp:new Date,body:e,data:{url:window.location.href}}))}},U=localStorage.getItem("__ACTIVITY_WORKING_TIME__"),K=localStorage.getItem("__ACTIVITY_RESTING_TIME__"),L=localStorage.getItem("__ACTIVITY_AUTOMATIC_SWAP__"),H={activityStatus:G("waiting"),timer:0,timeDisplay:G("00:00:00"),timeInterval:null,previousActivityStatus:"waiting",workingTime:U||52,restingTime:K||17,automatic:L||!0,timerDuration:function(t,e=!1){return e?"working"===t?60*this.restingTime:60*this.workingTime:"working"===t?60*this.workingTime:60*this.restingTime},toggleTimer:function(t){let e=!1,n=this.timerDuration(t);if(this.activityStatus.update(n=>{if(n!==t)return t;const i=function(t){let e;return t.subscribe(t=>e=t)(),e}(this.timeDisplay);return z.send("Timer paused!",`${this.previousActivityStatus.capitalize()} paused at: ${i}.`),e=!0,"waiting"}),["working","resting"].includes(t)&&this.previousActivityStatus!==t&&(this.timer=n,this.previousActivityStatus=t),H.stopTimer(),e)return;let i,r,o;H.timeInterval=setInterval(()=>{i=parseInt(H.timer/3600,10),r=parseInt(H.timer/60,10),o=parseInt(H.timer%60,10),i=i<10?"0"+i:i,r=r<10?"0"+r:r,o=o<10?"0"+o:o;const e=i+":"+r+":"+o;if(H.timeDisplay.update(t=>e),--H.timer<0){if(z.send("Timer finished!",H.previousActivityStatus.capitalize()+" finished!"),!this.automatic||"false"===this.automatic)return this.stopTimer();const e="working"===t?"resting":t;n=this.timerDuration(t,!0),this.previousActivityStatus=e,H.activityStatus.update(t=>e),H.timer=n}},1e3)},stopTimer:function(){clearInterval(H.timeInterval)}};function J(e){let n,i,r,o,s,c;return{c(){n=f("div"),i=f("div"),r=g(e[0]),o=m(),s=f("small"),c=g(e[1]),p(s,"class","svelte-1gj26nk"),p(i,"class","Page--Content svelte-1gj26nk"),p(n,"id","App--Page"),p(n,"class","App--Page_Center svelte-1gj26nk")},m(t,e){l(t,n,e),a(n,i),a(i,r),a(i,o),a(i,s),a(s,c)},p(t,[e]){1&e&&h(r,t[0]),2&e&&h(c,t[1])},i:t,o:t,d(t){t&&u(n)}}}function Q(t,e,n){let i,r,o=H.activityStatus;s(t,o,t=>n(1,r=t));let c=H.timeDisplay;return s(t,c,t=>n(0,i=t)),[i,r,o,c]}class X extends j{constructor(t){super(),Y(this,t,Q,J,o,{})}}function Z(e){let n,r,o,s,c,g,h,k,$,S,b,w,y,I,A,C,W,E,P,F,R,N,q,B;return{c(){n=f("div"),r=f("h2"),r.textContent="Settings",o=m(),s=f("div"),c=f("div"),g=f("label"),g.textContent="Working Time",h=m(),k=f("input"),$=m(),S=f("div"),b=f("label"),b.textContent="Resting Time",w=m(),y=f("input"),I=m(),A=f("div"),C=f("label"),C.textContent="Automatic",W=m(),E=f("select"),P=f("option"),P.textContent="Yes",F=f("option"),F.textContent="No",R=m(),N=f("div"),q=f("button"),q.textContent="Save",p(r,"class","App--Title"),p(g,"for","Settings__WorkingTime"),p(g,"class","svelte-21tit6"),p(k,"id","Settings__WorkingTime"),p(k,"type","number"),p(k,"placeholder","Working Time"),p(k,"name","Settings__WorkingTime"),p(k,"class","svelte-21tit6"),p(c,"class","Settings--Field svelte-21tit6"),p(b,"for","Settings__RestingTime"),p(b,"class","svelte-21tit6"),p(y,"id","Settings__RestingTime"),p(y,"type","number"),p(y,"placeholder","Resting Time"),p(y,"name","Settings__RestingTime"),p(y,"class","svelte-21tit6"),p(S,"class","Settings--Field svelte-21tit6"),p(C,"for","Settings__Automatic"),p(C,"class","svelte-21tit6"),P.__value="true",P.value=P.__value,F.__value="false",F.value=F.__value,p(E,"id","Settings__Automatic"),p(E,"placeholder","Automatic"),p(E,"name","Settings__Automatic"),p(E,"class","svelte-21tit6"),void 0===H.automatic&&x(()=>e[3].call(E)),p(A,"class","Settings--Field svelte-21tit6"),p(q,"class","svelte-21tit6"),p(N,"class","Settings--Field svelte-21tit6"),p(s,"class","Settings--Form svelte-21tit6"),p(n,"class","Page Settings svelte-21tit6")},m(t,u,f){l(t,n,u),a(n,r),a(n,o),a(n,s),a(s,c),a(c,g),a(c,h),a(c,k),_(k,H.workingTime),a(s,$),a(s,S),a(S,b),a(S,w),a(S,y),_(y,H.restingTime),a(s,I),a(s,A),a(A,C),a(A,W),a(A,E),a(E,P),a(E,F),T(E,H.automatic),a(s,R),a(s,N),a(N,q),f&&i(B),B=[d(k,"input",e[1]),d(y,"input",e[2]),d(E,"change",e[3]),d(q,"click",e[0])]},p(t,[e]){0&e&&v(k.value)!==H.workingTime&&_(k,H.workingTime),0&e&&v(y.value)!==H.restingTime&&_(y,H.restingTime),0&e&&T(E,H.automatic)},i:t,o:t,d(t){t&&u(n),i(B)}}}function tt(t,e,n){return[function(){localStorage.setItem("__ACTIVITY_WORKING_TIME__",H.workingTime),localStorage.setItem("__ACTIVITY_RESTING_TIME__",H.restingTime),localStorage.setItem("__ACTIVITY_AUTOMATIC_SWAP__",H.automatic)},function(){H.workingTime=v(this.value)},function(){H.restingTime=v(this.value)},function(){H.automatic=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this)}]}class et extends j{constructor(t){super(),Y(this,t,tt,Z,o,{})}}function nt(t){let e;return{c(){e=g("Pause Rest")},m(t,n){l(t,e,n)},d(t){t&&u(e)}}}function it(t){let e;return{c(){e=g("Start Rest")},m(t,n){l(t,e,n)},d(t){t&&u(e)}}}function rt(t){let e;return{c(){e=g("Pause Work")},m(t,n){l(t,e,n)},d(t){t&&u(e)}}}function ot(t){let e;return{c(){e=g("Start Work")},m(t,n){l(t,e,n)},d(t){t&&u(e)}}}function st(e){let n,r,o,s,g,v,h;function _(t,e){return"resting"!=t[0]?it:nt}let T=_(e),k=T(e);function $(t,e){return"working"!=t[0]?ot:rt}let S=$(e),b=S(e);return{c(){n=f("footer"),r=f("button"),k.c(),s=m(),g=f("button"),b.c(),p(r,"class",o=c("resting"==e[0]?"Footer--Button rest active":"Footer--Button rest")+" svelte-1l36fl0"),p(g,"class",v=c("working"==e[0]?"Footer--Button work active":"Footer--Button work")+" svelte-1l36fl0"),p(n,"class","svelte-1l36fl0")},m(t,o,c){l(t,n,o),a(n,r),k.m(r,null),a(n,s),a(n,g),b.m(g,null),c&&i(h),h=[d(r,"click",e[2]),d(g,"click",e[1])]},p(t,[e]){T!==(T=_(t))&&(k.d(1),k=T(t),k&&(k.c(),k.m(r,null))),1&e&&o!==(o=c("resting"==t[0]?"Footer--Button rest active":"Footer--Button rest")+" svelte-1l36fl0")&&p(r,"class",o),S!==(S=$(t))&&(b.d(1),b=S(t),b&&(b.c(),b.m(g,null))),1&e&&v!==(v=c("working"==t[0]?"Footer--Button work active":"Footer--Button work")+" svelte-1l36fl0")&&p(g,"class",v)},i:t,o:t,d(t){t&&u(n),k.d(),b.d(),i(h)}}}function ct(t,e,n){let i;return H.activityStatus.subscribe(t=>n(0,i=t)),[i,()=>H.toggleTimer("working"),()=>H.toggleTimer("resting")]}class at extends j{constructor(t){super(),Y(this,t,ct,st,o,{})}}function lt(e){let n,i;return{c(){n=f("button"),p(n,"class","btn trigger svelte-1a9gqvs")},m(t,r,o){l(t,n,r),o&&i(),i=d(n,"click",e[1])},p:t,i:t,o:t,d(t){t&&u(n),i()}}}function ut(e){let n,i,r,o;const s=new et({});return{c(){n=f("button"),i=m(),B(s.$$.fragment),p(n,"class","btn close svelte-1a9gqvs")},m(t,c,a){l(t,n,c),l(t,i,c),D(s,t,c),r=!0,a&&o(),o=d(n,"click",e[1])},p:t,i(t){r||(N(s.$$.fragment,t),r=!0)},o(t){q(s.$$.fragment,t),r=!1},d(t){t&&u(n),t&&u(i),M(s,t),o()}}}function ft(t){let e,n,r,o,s,c,g,d,v;const h=[ut,lt],_=[];function T(t,e){return!0===t[0]?0:1}s=T(t),c=_[s]=h[s](t);const k=new X({}),$=new at({});return{c(){e=f("main"),n=f("h2"),n.textContent="timer",r=m(),o=f("div"),c.c(),g=m(),B(k.$$.fragment),d=m(),B($.$$.fragment),p(n,"class","App--Title svelte-1a9gqvs"),p(o,"class","App--Settings svelte-1a9gqvs"),p(e,"id","App"),p(e,"class","svelte-1a9gqvs")},m(t,i){l(t,e,i),a(e,n),a(e,r),a(e,o),_[s].m(o,null),a(e,g),D(k,e,null),a(e,d),D($,e,null),v=!0},p(t,[e]){let n=s;s=T(t),s===n?_[s].p(t,e):(R={r:0,c:[],p:R},q(_[n],1,1,()=>{_[n]=null}),R.r||i(R.c),R=R.p,c=_[s],c||(c=_[s]=h[s](t),c.c()),N(c,1),c.m(o,null))},i(t){v||(N(c),N(k.$$.fragment,t),N($.$$.fragment,t),v=!0)},o(t){q(c),q(k.$$.fragment,t),q($.$$.fragment,t),v=!1},d(t){t&&u(e),_[s].d(),M(k),M($)}}}function gt(t,e,n){let i=!1;return[i,function(){n(0,i=!i)}]}String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const mt={app:new class extends j{constructor(t){super(),Y(this,t,gt,ft,o,{})}}({target:document.body}),registerServiceWorker:function(){"serviceWorker"in navigator&&(z.requestPermission(),navigator.serviceWorker.register("/service-worker.js").catch(this.workerErrorCallback))},workerErrorCallback:t=>console.warn("Worker failed:",t)};return mt.registerServiceWorker(),mt.app}();
